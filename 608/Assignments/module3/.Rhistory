install.packages(c("plotly", "shinydashboard"))
library(shiny)
library(shinydashboard)
library(plotly)
library(tidyverse)
library(dplyr)
Mortalitydata<- read.csv("https://raw.githubusercontent.com/charleyferrari/CUNY_DATA608/master/lecture3/data/cleaned-cdc-mortality-1999-2010-2.csv")
Mortality2010<-Mortalitydata %>% filter(Year==2010)
CauseofDeaths<-as.vector(unique(Mortality2010$ICD.Chapter))
Location<-as.vector(unique(Mortalitydata$State))
{ui <-
dashboardPage(
dashboardHeader(title = "Mortality Rate"),
dashboardSidebar(
),
dashboardBody(
fluidRow(
tabBox(width = 100, height = 5000,
tabPanel("Question 1",
column(10,plotlyOutput("Question1_PlotA")),
column(10, selectInput(width = 10000,inputId = "CauseofDeath", label = "Select Cause of Death",
choices = sort(CauseofDeaths),
selected = 1))
),
tabPanel("Question 2",
column(10,plotlyOutput("Question2_PlotA")),
column(10, selectInput(width = 10000,inputId = "RateofDeath", label = "Select Location of Interest",
choices = sort(Location),
selected = 1))
)
)
)))
# Define server logic ----
server <- function(input, output) {
# coolplot1a --------------------------------------------------------------
output$Question1_PlotA<-renderPlotly({
Mortality2010<-Mortality2010 %>% filter(ICD.Chapter==input$CauseofDeath)
ggplotly(
ggplot(Mortality2010)+
geom_col(mapping = aes(x = reorder(State,Crude.Rate, FUN = sum), y = Crude.Rate), fill = 'grey50', alpha = .5)+
theme_minimal()+
theme(axis.text.x=element_text(angle = 90))+
labs(x = "Crude Death Rate",
y = "State",
title = paste0("States Ranked by Crude Mortality Rate\n",input$CauseofDeath)
)
)
})
# coolplot1b --------------------------------------------------------------
output$Question2_PlotA<-renderPlotly({
Mortalitydata_sub<- Mortalitydata %>% filter(State==input$RateofDeath)
ggplotly(
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
labs(x = "Date",
y = "Crude Mortality Rate",
title = "Mortality Rate over Time")
)
})
}
# Run the app ----
shinyApp(ui = ui, server = server)
}
Mortalitydata_sub<- Mortalitydata %>% filter(ICD.Chapter==x[1])
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate, color), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
Mortalitydata_sub<- Mortalitydata %>% filter(ICD.Chapter==x[1])
x<-as.vector(unique(Mortalitydata$ICD.Chapter)
x<-as.vector(unique(Mortalitydata$ICD.Chapter))
x<-as.vector(unique(Mortalitydata$ICD.Chapter))
Mortalitydata_sub<- Mortalitydata %>% filter(ICD.Chapter==x[1])
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate, color), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Year), y = max(crude.Rate))
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Year), y = max(crude.Rate))
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(mortalitydata$Year), y = max(crude.Rate))
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(crude.Rate))
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(Mortalitydata_sub(crude.Rate))
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(Mortalitydata_sub(crude.Rate)))
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(Mortalitydata_sub(crude.Rate)))
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(Mortalitydata_sub$crude.Rate)), label = "test")
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(Mortalitydata_sub$crude.Rate)), label = "test")
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(Mortalitydata_sub$crude.Rate), label = "test")
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(50), label = "test")
max(Mortalitydata_sub$crude.Rate)
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y = max(Mortalitydata_sub$Crude.Rate), label = "test")
tail(Mortalitydata_sub$Crude.Rate)
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y =tail(Mortalitydata_sub$Crude.Rate), label = "test")
Mortalitydata_sub$Crude.Rate[4]
Mortalitydata_sub$Crude.Rate[length((Mortalitydata_sub$Crude.Rate)
Mortalitydata_sub$Crude.Rate[length((Mortalitydata_sub$Crude.Rate))]
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y =Mortalitydata_sub$Crude.Rate[length((Mortalitydata_sub$Crude.Rate))], label = "test")
ggplot()+
stat_summary(data = Mortalitydata, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "red")+
stat_summary(data = Mortalitydata_sub, geom = "line", mapping = aes(x = Year, y = Crude.Rate), fun.y = mean, color = "black")+
theme_classic()+
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank())+
annotate(geom = "text", x = max(Mortalitydata_sub$Year), y =Mortalitydata_sub$Crude.Rate[length((Mortalitydata_sub$Crude.Rate))], label = "test")+
annotate(geom = "text", x = max(Mortalitydata$Year), y =Mortalitydata$Crude.Rate[length((Mortalitydata$Crude.Rate))], label = "test2")
